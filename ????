-- Check current room
local entityModel = true
local latestRoom = game.ReplicatedStorage.GameData.LatestRoom.Value

-- If in Seek, Figure, or Room 50+, don't spawn the entity
if game.Workspace:FindFirstChild("SeekMovingNewClone") or 
   latestRoom == 50 or latestRoom >= 90 then
    entityModel = false
end

if entityModel then
    local Kill = true
    local unknown = game:GetObjects("rbxassetid://10840326834")[1] -- Load UnKnoWn model
    unknown.Name = "UnKnoWn"
    unknown.Parent = game.Workspace

    local part = unknown:FindFirstChildWhichIsA("BasePart") or unknown:FindFirstChildWhichIsA("Part")

    -- Set the position of UnKnoWn in the current room
    part.CFrame = game.Workspace.CurrentRooms:GetChildren()[#game.Workspace.CurrentRooms:GetChildren() - 1].Parts.Floor.CFrame + Vector3.new(0, 6, 0)

    -- Break all lights (only break, no disabling or sound)
    for _, obj in ipairs(game.Workspace:GetDescendants()) do
        if obj:IsA("Model") and obj:FindFirstChild("Light") and obj:FindFirstChild("Break") then
            local breakPart = obj:FindFirstChild("Break")
            if breakPart then
                breakPart:Destroy()
            end
        end
    end

    wait(3)

    task.spawn(function()
        while Kill == true do
            task.wait(1)
            local char = game.Players.LocalPlayer.Character
            if char and char:FindFirstChild("Humanoid") then
                local humanoid = char.Humanoid

                -- Check if crouching (via HipHeight)
                local isCrouching = humanoid.HipHeight <= 0.4

                if not isCrouching then
                    humanoid:TakeDamage(10)
                end

                if humanoid.Health <= 0 then
                    firesignal(game.ReplicatedStorage.RemotesFolder.DeathHint.OnClientEvent, 
                        {"You died to who you call UnKnoWn...", "It punishes those who stand tall.", "Crouch to survive!"}, "Red")
                    wait(0.01)
                    game:GetService("ReplicatedStorage").GameStats["Player_".. game.Players.LocalPlayer.Name].Total.DeathCause.Value = "UnKnoWn"
                end
            end
        end
    end)

    -- Wait for the room to change
    game.ReplicatedStorage.GameData.LatestRoom.Changed:Wait()
    Kill = false

    -- Destroy UnKnoWn entity
    unknown:Destroy()
end

---====== Load achievement giver ======---
local achievementGiver = loadstring(game:HttpGet("https://raw.githubusercontent.com/RegularVynixu/Utilities/main/Doors/Custom%20Achievements/Source.lua"))()

---====== Display achievement ======---
achievementGiver({
    Title = "Crouch or Die",
    Desc = "Gone?.",
    Reason = "Survived and encountered UnKnoWn.",
    Image = "rbxassetid://71340141113006"
})

